<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>YouTube Frontend</title>
</head>
<body>
  <h2>YouTube MP4再生</h2>
  <input type="text" id="videoId" placeholder="動画IDを入力 (例: dQw4w9WgXcQ)" />
  <button onclick="playVideo()">再生</button>
  <br><br>
  <video id="player" controls width="640"></video>

  <script>
    // Render サーバーのURLに置き換える
    const SERVER = "https://あなたの-render-app.onrender.com";

    async function playVideo() {
      const id = document.getElementById("videoId").value.trim();
      if (!id) return alert("動画IDを入力してください");

      try {
        // MP4 URL を取得
        const res = await fetch(`${SERVER}/api/video/${id}`);
        const data = await res.json();

        if (data.error) {
          console.error("Error:", data);
          alert("動画取得エラー: " + data.error);
          return;
        }

        // Proxy 経由でCORS回避
        const videoUrl = `${SERVER}/proxy-video?url=${encodeURIComponent(data.videoUrl)}`;

        const player = document.getElementById("player");
        player.src = videoUrl;
        player.play();
      } catch (e) {
        console.error("Fetch error:", e);
        alert("通信エラーが発生しました");
      }
    }
  </script>
</body>
</html>
